{"ast":null,"code":"import { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { AuthService } from '../../account/shared/auth.service';\nimport { PagerService } from '../../pager/pager.service';\nimport { ProductsCacheService } from '../shared/products-cache.service';\nimport { ProductService } from '../shared/product.service';\nimport { UiService } from '../shared/ui.service';\nimport { SortPipe } from '../shared/sort.pipe';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared/product.service\";\nimport * as i2 from \"../shared/products-cache.service\";\nimport * as i3 from \"../../pager/pager.service\";\nimport * as i4 from \"../shared/sort.pipe\";\nimport * as i5 from \"../../account/shared/auth.service\";\nimport * as i6 from \"../shared/ui.service\";\nimport * as i7 from \"../../core/page-title/page-title.component\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"../products-list-item/products-list-item.component\";\n\nfunction ProductsListComponent_div_41_app_products_list_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-products-list-item\", 22);\n    i0.ɵɵpipe(1, \"async\");\n  }\n\n  if (rf & 2) {\n    const product_r5 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"product\", product_r5)(\"displayMode\", i0.ɵɵpipeBind1(1, 2, ctx_r4.uiService.displayMode$));\n  }\n}\n\nfunction ProductsListComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtemplate(1, ProductsListComponent_div_41_app_products_list_item_1_Template, 2, 4, \"app-products-list-item\", 21);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.productsPaged);\n  }\n}\n\nfunction ProductsListComponent_div_43_app_products_list_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-products-list-item\", 24);\n    i0.ɵɵpipe(1, \"async\");\n  }\n\n  if (rf & 2) {\n    const product_r7 = ctx.$implicit;\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"product\", product_r7)(\"displayMode\", i0.ɵɵpipeBind1(1, 2, ctx_r6.uiService.displayMode$));\n  }\n}\n\nfunction ProductsListComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtemplate(1, ProductsListComponent_div_43_app_products_list_item_1_Template, 2, 4, \"app-products-list-item\", 23);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.products);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    active: a0\n  };\n};\n\nfunction ProductsListComponent_nav_45_li_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 34)(1, \"a\", 35);\n    i0.ɵɵlistener(\"click\", function ProductsListComponent_nav_45_li_7_Template_a_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const page_r9 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.setPage(page_r9);\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const page_r9 = ctx.$implicit;\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r8.pager.currentPage === page_r9));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(page_r9);\n  }\n}\n\nconst _c1 = function (a0) {\n  return {\n    disabled: a0\n  };\n};\n\nfunction ProductsListComponent_nav_45_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"nav\", 25)(1, \"div\", 26)(2, \"a\", 27);\n    i0.ɵɵlistener(\"click\", function ProductsListComponent_nav_45_Template_a_click_2_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.setPage(ctx_r12.pager.currentPage - 1);\n    });\n    i0.ɵɵelement(3, \"i\", 28);\n    i0.ɵɵtext(4, \"\\u00A0Previous \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 29)(6, \"ul\", 30);\n    i0.ɵɵtemplate(7, ProductsListComponent_nav_45_li_7_Template, 3, 4, \"li\", 31);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 32)(9, \"a\", 27);\n    i0.ɵɵlistener(\"click\", function ProductsListComponent_nav_45_Template_a_click_9_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.setPage(ctx_r14.pager.currentPage + 1);\n    });\n    i0.ɵɵtext(10, \"Next\\u00A0 \");\n    i0.ɵɵelement(11, \"i\", 33);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(3, _c1, ctx_r3.pager.currentPage === 1));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.pager.pages);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(5, _c1, ctx_r3.pager.currentPage === ctx_r3.pager.totalPages));\n  }\n}\n\nconst _c2 = function () {\n  return {\n    title: \"Products\"\n  };\n};\n\nconst _c3 = function (a0) {\n  return [a0];\n};\n\nconst _c4 = function (a0) {\n  return {\n    \"loading\": a0\n  };\n};\n\nexport let ProductsListComponent = /*#__PURE__*/(() => {\n  class ProductsListComponent {\n    constructor(productService, productsCacheService, pagerService, sortPipe, authService, uiService) {\n      this.productService = productService;\n      this.productsCacheService = productsCacheService;\n      this.pagerService = pagerService;\n      this.sortPipe = sortPipe;\n      this.authService = authService;\n      this.uiService = uiService;\n      this.unsubscribe$ = new Subject();\n      this.pager = {};\n    }\n\n    ngOnInit() {\n      this.authService.user.pipe(takeUntil(this.unsubscribe$)).subscribe(user => {\n        this.user = user;\n      });\n      this.uiService.currentPagingPage$.pipe(takeUntil(this.unsubscribe$)).subscribe(page => {\n        this.currentPagingPage = page;\n      });\n      this.getProducts();\n    }\n\n    getProducts() {\n      this.productsLoading = true;\n      this.productService.getProducts().pipe(takeUntil(this.unsubscribe$)).subscribe(products => {\n        this.products = products;\n        this.setPage(this.currentPagingPage);\n        this.productsLoading = false;\n      });\n    }\n\n    onDisplayModeChange(mode, e) {\n      this.uiService.displayMode$.next(mode);\n      e.preventDefault();\n    }\n\n    setPage(page) {\n      if (page < 1 || page > this.pager.totalPages) {\n        return;\n      }\n\n      this.pager = this.pagerService.getPager(this.products.length, page, 8);\n      this.productsPaged = this.products.slice(this.pager.startIndex, this.pager.endIndex + 1);\n      this.uiService.currentPagingPage$.next(page);\n    }\n\n    onSort(sortBy) {\n      this.sortPipe.transform(this.products, sortBy.replace(':reverse', ''), sortBy.endsWith(':reverse'));\n      this.uiService.sorting$.next(sortBy);\n      this.setPage(1);\n    }\n\n    ngOnDestroy() {\n      this.unsubscribe$.next();\n      this.unsubscribe$.complete();\n    }\n\n  }\n\n  ProductsListComponent.ɵfac = function ProductsListComponent_Factory(t) {\n    return new (t || ProductsListComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.ProductsCacheService), i0.ɵɵdirectiveInject(i3.PagerService), i0.ɵɵdirectiveInject(i4.SortPipe), i0.ɵɵdirectiveInject(i5.AuthService), i0.ɵɵdirectiveInject(i6.UiService));\n  };\n\n  ProductsListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsListComponent,\n    selectors: [[\"app-products\"]],\n    decls: 47,\n    vars: 41,\n    consts: [[\"title\", \"Products\", 3, \"children\"], [1, \"container\", \"padding-bottom-3x\", \"mb-1\"], [1, \"shop-toolbar\", \"padding-bottom-1x\", \"mb-2\"], [1, \"column\"], [1, \"shop-sorting\"], [\"for\", \"sorting\"], [\"id\", \"sorting\", 1, \"form-control\", 3, \"change\"], [\"selectSort\", \"\"], [\"value\", \"date:reverse\", 3, \"selected\"], [\"value\", \"price\", 3, \"selected\"], [\"value\", \"price:reverse\", 3, \"selected\"], [\"value\", \"name\", 3, \"selected\"], [\"value\", \"name:reverse\", 3, \"selected\"], [1, \"text-muted\"], [1, \"shop-view\"], [\"href\", \"\", 1, \"grid-view\", 3, \"ngClass\", \"click\"], [\"href\", \"\", 1, \"list-view\", 3, \"ngClass\", \"click\"], [1, \"products-list\", 3, \"ngClass\"], [\"class\", \"row\", 4, \"ngIf\"], [\"class\", \"pagination\", 4, \"ngIf\"], [1, \"row\"], [\"ngClass\", \"col-12 col-sm-6 col-md-4 col-lg-3\", 3, \"product\", \"displayMode\", 4, \"ngFor\", \"ngForOf\"], [\"ngClass\", \"col-12 col-sm-6 col-md-4 col-lg-3\", 3, \"product\", \"displayMode\"], [\"ngClass\", \"col-12\", 3, \"product\", \"displayMode\", 4, \"ngFor\", \"ngForOf\"], [\"ngClass\", \"col-12\", 3, \"product\", \"displayMode\"], [1, \"pagination\"], [1, \"column\", \"text-left\", \"hidden-xs-down\"], [1, \"btn\", \"btn-outline-secondary\", \"btn-sm\", 3, \"ngClass\", \"click\"], [1, \"icon-arrow-left\"], [1, \"column\", \"text-center\"], [1, \"pages\"], [3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"column\", \"text-right\", \"hidden-xs-down\"], [1, \"icon-arrow-right\"], [3, \"ngClass\"], [3, \"click\"]],\n    template: function ProductsListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r15 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelement(0, \"app-page-title\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"label\", 5);\n        i0.ɵɵtext(6, \"Sort by:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"select\", 6, 7);\n        i0.ɵɵlistener(\"change\", function ProductsListComponent_Template_select_change_7_listener() {\n          i0.ɵɵrestoreView(_r15);\n\n          const _r0 = i0.ɵɵreference(8);\n\n          return ctx.onSort(_r0.value);\n        });\n        i0.ɵɵelementStart(9, \"option\", 8);\n        i0.ɵɵpipe(10, \"async\");\n        i0.ɵɵtext(11, \"Newest Articles\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"option\", 9);\n        i0.ɵɵpipe(13, \"async\");\n        i0.ɵɵtext(14, \"Low - High Price\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"option\", 10);\n        i0.ɵɵpipe(16, \"async\");\n        i0.ɵɵtext(17, \"High - Low Price\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"option\", 11);\n        i0.ɵɵpipe(19, \"async\");\n        i0.ɵɵtext(20, \"A - Z Order\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"option\", 12);\n        i0.ɵɵpipe(22, \"async\");\n        i0.ɵɵtext(23, \"Z - A Order\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(24, \"span\", 13);\n        i0.ɵɵtext(25, \"Showing:\\u00A0\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"span\");\n        i0.ɵɵtext(27, \"1 - 12 items\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"div\", 3)(29, \"div\", 14)(30, \"a\", 15);\n        i0.ɵɵlistener(\"click\", function ProductsListComponent_Template_a_click_30_listener($event) {\n          return ctx.onDisplayModeChange(\"grid\", $event);\n        });\n        i0.ɵɵpipe(31, \"async\");\n        i0.ɵɵelement(32, \"span\")(33, \"span\")(34, \"span\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(35, \"a\", 16);\n        i0.ɵɵlistener(\"click\", function ProductsListComponent_Template_a_click_35_listener($event) {\n          return ctx.onDisplayModeChange(\"list\", $event);\n        });\n        i0.ɵɵpipe(36, \"async\");\n        i0.ɵɵelement(37, \"span\")(38, \"span\")(39, \"span\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(40, \"div\", 17);\n        i0.ɵɵtemplate(41, ProductsListComponent_div_41_Template, 2, 1, \"div\", 18);\n        i0.ɵɵpipe(42, \"async\");\n        i0.ɵɵtemplate(43, ProductsListComponent_div_43_Template, 2, 1, \"div\", 18);\n        i0.ɵɵpipe(44, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(45, ProductsListComponent_nav_45_Template, 12, 7, \"nav\", 19);\n        i0.ɵɵpipe(46, \"async\");\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"children\", i0.ɵɵpureFunction1(33, _c3, i0.ɵɵpureFunction0(32, _c2)));\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"selected\", i0.ɵɵpipeBind1(10, 12, ctx.uiService.sorting$) === \"date:reverse\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"selected\", i0.ɵɵpipeBind1(13, 14, ctx.uiService.sorting$) === \"price\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"selected\", i0.ɵɵpipeBind1(16, 16, ctx.uiService.sorting$) === \"price:reverse\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"selected\", i0.ɵɵpipeBind1(19, 18, ctx.uiService.sorting$) === \"name\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"selected\", i0.ɵɵpipeBind1(22, 20, ctx.uiService.sorting$) === \"name:reverse\");\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(35, _c0, i0.ɵɵpipeBind1(31, 22, ctx.uiService.displayMode$) === \"grid\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(37, _c0, i0.ɵɵpipeBind1(36, 24, ctx.uiService.displayMode$) === \"list\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(39, _c4, ctx.productsLoading));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(42, 26, ctx.uiService.displayMode$) === \"grid\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(44, 28, ctx.uiService.displayMode$) === \"list\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.pager.pages && ctx.pager.pages.length && i0.ɵɵpipeBind1(46, 30, ctx.uiService.displayMode$) === \"grid\");\n      }\n    },\n    directives: [i7.PageTitleComponent, i8.NgSelectOption, i8.ɵNgSelectMultipleOption, i9.NgClass, i9.NgIf, i9.NgForOf, i10.ProductsListItemComponent],\n    pipes: [i9.AsyncPipe],\n    styles: [\".products-list.loading[_ngcontent-%COMP%]{min-height:200px;background:url(loading.gif) center center no-repeat}.shop-toolbar[_ngcontent-%COMP%]{display:table;width:100%}.shop-toolbar[_ngcontent-%COMP%] > .column[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}.shop-toolbar[_ngcontent-%COMP%] > .column[_ngcontent-%COMP%]:last-child{text-align:right}@media (max-width: 576px){.shop-toolbar[_ngcontent-%COMP%] > .column[_ngcontent-%COMP%]{display:block;width:100%;text-align:center}.shop-toolbar[_ngcontent-%COMP%] > .column[_ngcontent-%COMP%]:last-child{padding-top:24px;text-align:center}}.shop-sorting[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .shop-sorting[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .shop-sorting[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.shop-sorting[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:8px 0}.shop-sorting[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:0;padding:8px 5px 8px 0;color:#9da9b9;font-size:14px;font-weight:400}.shop-sorting[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;max-width:186px;margin-right:10px}@media (max-width: 576px){.shop-sorting[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .shop-sorting[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{display:block;width:100%;max-width:100%;margin:0;padding-top:0;padding-right:0}}.shop-view[_ngcontent-%COMP%]{display:inline-block}.shop-view[_ngcontent-%COMP%]:after{display:block;clear:both;content:\\\"\\\"}.shop-view[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{display:block;width:43px;height:43px;margin-left:10px;padding:13px;float:left;transition:background-color .35s;border:1px solid #e1e7ec;border-radius:50%;background-color:#fff}.shop-view[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:relative;width:3px;height:3px;margin-bottom:3px;background-color:#606975}.shop-view[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before, .shop-view[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{display:block;position:absolute;background-color:#606975}.shop-view[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{margin-bottom:0}.shop-view[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.shop-view[_ngcontent-%COMP%] > a.active[_ngcontent-%COMP%]{border-color:#0da9ef;background-color:#0da9ef;cursor:default;pointer-events:none}.shop-view[_ngcontent-%COMP%] > a.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .shop-view[_ngcontent-%COMP%] > a.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before, .shop-view[_ngcontent-%COMP%] > a.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{background-color:#fff}.shop-view[_ngcontent-%COMP%] > a.grid-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before, .shop-view[_ngcontent-%COMP%] > a.grid-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{top:0;width:3px;height:3px;content:\\\"\\\"}.shop-view[_ngcontent-%COMP%] > a.grid-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{left:6px}.shop-view[_ngcontent-%COMP%] > a.grid-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{left:12px}.shop-view[_ngcontent-%COMP%] > a.list-view[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{top:1px;left:6px;width:9px;height:1px;content:\\\"\\\"}\"]\n  });\n  return ProductsListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}